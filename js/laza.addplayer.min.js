!function(e){"use strict";e.fn.addPlayer=function(a){if("undefined"!=typeof e.fn.jPlayer){a=e.extend({},e.fn.addPlayer.defaults,a);var t=getTranslations(e.fn.addPlayer.text),i=navigator.userAgent.indexOf("Firefox")>=0&&navigator.platform.indexOf("Mac")>=0,n={cont:"jp-cont",mini:"jp-mini",audio:"jp-audio",video:"jp-video",playerType:"jp-type-single",player:"jp-jplayer",title:"jp-title",progress:"jp-progress",controls:"jp-controls-holder",startStop:"jp-startstop",volume:"jp-volume",times:"jp-times",toggles:"jp-toggles",warning:"jp-warning",videoPlay:"jp-video-play",play:"jp-play",pause:"jp-pause",stop:"jp-stop",seekBar:"jp-seek-bar",playBar:"jp-play-bar",mute:"jp-mute",unmute:"jp-unmute",volumeBar:"jp-volume-bar",volumeBarValue:"jp-volume-bar-value",volumeMax:"jp-volume-max",currentTime:"jp-current-time",duration:"jp-duration",fullScreen:"jp-full-screen",restoreScreen:"jp-restore-screen",repeat:"jp-repeat",repeatOff:"jp-repeat-off",gui:"jp-gui",noSolution:"jp-no-solution",playing:"playing"},s=function(e){var a,i=function(e){return'<a class="'+n[e]+'" title="'+t[e]+'">'+t[e]+"</a>"};return a='<div class="'+n.progress+'"><div class="'+n.seekBar+'"><div class="'+n.playBar+'"></div></div></div>',a+='<div class="'+n.controls+'">',a+='<div class="'+n.startStop+'">'+i("play")+i("pause")+i("stop")+"</div>",a+='<div class="'+n.volume+'">'+i("mute")+i("unmute")+'<div class="'+n.volumeBar+'"><div class="'+n.volumeBarValue+'"></div></div></div>',a+='<div class="'+n.times+'"><div class="'+n.currentTime+'"></div><div class="'+n.duration+'"></div></div>',a+='<div class="'+n.toggles+'">'+(e?"":i("fullScreen")+i("restoreScreen"))+i("repeat")+i("repeatOff")+"</div>",a+="</div>"},r=function(e){var a=e.css("paddingTop"),t=e.css("paddingLeft"),i=e.css("paddingRight"),s=e.css("paddingBottom");e.find("."+n.gui).css({bottom:s,left:t,right:i}),e.find("."+n.title).css({top:a,left:t,right:i})},o=function(a,i,o){"absolute"!==a.css("position")&&"fixed"!==a.css("position")&&a.css({position:"relative"}),a.css({overflow:"hidden"});var l,d=e('<div class="'+(o?n.audio:n.video)+'"></div>').appendTo(a);return d=e('<div class="'+n.playerType+'"></div>').appendTo(d),l=e('<div class="'+n.player+'"></div>').appendTo(d),d.append('<div class="'+n.videoPlay+'"><a>'+t.play+"</a></div>"),i&&d.append('<div class="'+n.title+'" data-noswipe><ul><li>'+i+"</li></ul></div>"),d.append('<div class="'+n.gui+'" data-noswipe>'+s(o)+"</div>"),a.hasClass(n.fullScreen)&&d.find("."+n.gui).hide(),a.append('<div class="'+n.noSolution+'">'+t.unsupportedMediaFormat+"</div>"),r(a),l},l=function(){var a;return(a=e(this).data("media"))&&a.jPlayer("pause"),!1},d=function(){var a;return(a=e(this).data("media"))&&a.jPlayer("destroy"),e(window).off("keydown",f),!1},p=function(){var a;return(a=e(this).data("media"))&&a.jPlayer("stop"),!1},u=function(){var a;return(a=e(this).data("media"))&&a.jPlayer("play"),!1},c=e(this).eq(0),f=function(e){if(document.activeElement&&("INPUT"===document.activeElement.nodeName||"TEXTAREA"===document.activeElement.nodeName))return!0;var a=e?e.keyCode:window.event.keyCode;return 32===a?(c.find("."+n.player).jPlayer(c.data(n.playing)?"pause":"play"),!1):!0},v=function(e){return a.hasOwnProperty("audio")?a.audio:".mp3.m4a.f4a.rtmpa".indexOf(e.getExt())>0},y=function(e){var a,t=v(e)?"a":"v";switch(e.getExt()){case"mp3":a="mp3";break;case"mp4":a="m4"+t;break;case"ogg":a="og"+t;break;case"webm":a="webm"+t;break;case"flv":case"f4a":case"f4v":a="fl"+t;break;case"rtmp":a="rtmp"+t;break;default:a=null}return a};return this.each(function(){var s,r,c,m,g,h,j,P,w=e(this),b=a.folder||"",k=e(),T=0,S=function(){var t,i,n={},s=a.relativeUrl?"":location.href.substring(0,location.href.lastIndexOf("/")+1);return e.isArray(g)?(T>=g.length&&(T=0),t=g[T]):(t=g,j&&(n.poster=(s+b+j).fixUrl())),i=y(t),n[i]=(s+b+t).fixUrl(),n},x=function(){if(e.cookie){var a=w.find("."+n.currentTime).text().split(":");a=a.length>2?60*(60*parseInt(a[0],10)+parseInt(a[1],10))+parseInt(a[2],10):60*parseInt(a[0],10)+parseInt(a[1],10),e.cookie("jp_"+w[0].id,(w.data(n.playing)?"1":"0")+"::"+a+"::"+P.jPlayer("option","volume").toString().substring(0,5)+(T?"::"+T:""))}},O=function(a){if(e.cookie){var t=e.cookie("jp_"+a[0].id);if(t)return t=t.split("::"),{playing:"1"===t[0],time:parseInt(t[1]||0,10),volume:parseFloat(t[2]||.8),curr:parseInt(t[3]||0,10)}}return null};if(a.elem){k=e(this).find(a.elem),h=k.attr("title");var F=k.find("img:first");F.length?(g=F.data("link"),j=F.data("poster")||F.attr("src"),h||(h=F.attr("alt"))):(g=k.attr("href"),j=h="")}else g=a.src,h=a.title||"",j=a.poster||"",k=e('<a href="'+g+'"'+(h?' title="'+h+'"':"")+">"+(j?'<img src="'+j+'">':"")+"</a>").appendTo(e(this));if(g){if(LOCAL){var I=e('<div class="'+n.warning+'">'+t.localFlashWarning+"</a></div>").appendTo(k);k.css("position","relative"),I.hide(),setTimeout(function(){I.fadeIn()},2e3)}g.indexOf("::")>0?(g=g.split("::"),s=v(g[0]),r=y(g[0])):(s=v(g),r=y(g)),this.id||(this.id=a.id+e.fn.addPlayer.id++),m="#"+this.id,e(w).addClass(n.cont),a.mini&&e(w).addClass(n.mini),P=o(w,a.showTitle?h:"",s),c=!s&&!i,w.on("setEndedFn",function(t,i){a.ended=i&&e.isFunction(i)?i:null}),P.jPlayer({cssSelectorAncestor:m,backgroundColor:a.backgroundColor,supplied:r,swfPath:a.resPath+"/"+a.swf,solution:a.solution,size:{width:"100%",height:"100%"},fullWindow:!s&&a.fullScreen,preload:"auto",loop:a.loop,volume:a.volume,autohide:{restored:c,full:c},ready:function(){var t=e(this),i=a.saveStatus?O(w):null;w.data("media",t),a.saveStatus&&(e(window).on("unload",x),i&&(T=i.curr));var s=S();if(k&&k.hide(),t.jPlayer("setMedia",s),w.on({play:u,pause:l,stop:p,destroy:d}),a.saveStatus&&i&&i.playing||a.auto){var r=50,o=function(){var e=w.find("."+n.videoPlay),a=w.find("."+n.gui),i=t.find("audio,video")[0];!i||i.paused||i.readyState<2?(e.is(":visible")||e.fadeIn(),a.is(":visible")&&a.fadeOut(),--r&&setTimeout(o,200)):e.hide()};setTimeout(o,1e3)}a.saveStatus&&i?(t.jPlayer("volume",i.volume),t.jPlayer(i.playing?"play":"pause",i.time)):a.auto&&t.jPlayer("play"),a.lowPriority||e(window).on("keydown",f)},play:function(){e(this).jPlayer("pauseOthers"),a.mini||w.find("."+n.videoPlay).fadeOut(),w.data(n.playing,!0),TOUCHENABLED&&setTimeout(function(){w.find("."+n.title).fadeOut(1e3)},600),e.isFunction(a.play)&&a.play.call()},pause:function(){a.mini||w.find("."+n.videoPlay).fadeIn(),w.data(n.playing,!1),e.isFunction(a.pause)&&a.pause.call()},stop:function(){w.data(n.playing,!1),TOUCHENABLED&&w.find("."+n.title).fadeIn(300),e.isFunction(a.stop)&&a.stop.call()},ended:function(){e.isArray(g)&&(T+1<g.length||a.loop)?(T=(T+1)%g.length,e(this).jPlayer("setMedia",S()),e(this).jPlayer("play")):w.data(n.playing,!1),e.isFunction(a.ended)&&a.ended.call()}})}})}},e.fn.addPlayer.id=0,e.fn.addPlayer.defaults={id:"jp_container_",backgroundColor:"#000000",resPath:"",swf:"Jplayer.swf",relativeUrl:!1,solution:"html,flash",volume:.8,auto:!1,loop:!1,keyboard:!0,lowPriority:!1,saveStatus:!1,mini:!1,fullScreen:!1,showTitle:!1,size:{width:"100%",height:"100%"}},e.fn.addPlayer.text={play:"play",pause:"pause",stop:"stop",mute:"mute",unmute:"unmute",fullScreen:"full screen",restoreScreen:"restore screen",repeat:"repeat",repeatOff:"repeat off",localFlashWarning:"Local Flash playback is possibly blocked by Flash security rules. Test videos in the uploaded album!",unsupportedMediaFormat:'<span>Unsupported media format</span>You might need to either update your browser or the <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a> or use another browser to play this media.'}}(jQuery);