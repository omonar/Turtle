!function(e){"use strict";e.getLatLng=function(e){return"undefined"==typeof google||null==e?null:"string"==typeof e?(e=e.split(","),new google.maps.LatLng(parseFloat(e[0])||0,parseFloat(e[e.length-1])||0)):new google.maps.LatLng(e[0],e[1])},e.fn.addMap=function(o){if("undefined"==typeof google||!google.maps)return this;o=e.extend({},e.fn.addMap.defaults,o);var a=o.resPath+"/marker-curr.png",t=o.resPath+"/marker.png",n=new google.maps.MarkerImage(a,new google.maps.Size(17,24),new google.maps.Point(0,0),new google.maps.Point(8,24)),r=new google.maps.MarkerImage(t,new google.maps.Size(17,24),new google.maps.Point(0,0),new google.maps.Point(8,24)),s=new google.maps.MarkerImage(o.resPath+"/marker-shadow.png",new google.maps.Size(24,24),new google.maps.Point(0,0),new google.maps.Point(8,24));return this.each(function(){var i,g,p,l,m,d,u,c=e(this),h=[];c.readData(o,"type,zoom,map,label,resPath,markers");var f=function(){c&&c.data("fresh")&&(p&&c.is(":visible")&&!c.parents(":hidden").length&&c.width()&&c.height()?(clearTimeout(m),c.width(c.parent().width()),google.maps.event.trigger(p,"resize"),p.setCenter(i),c.data("fresh",!1)):m=setTimeout(f,200))};if(l&&l.length&&l.remove(),l=e("<div>").css({position:"absolute",top:"-9000px",width:c.width(),height:c.height()}).appendTo("body"),c.data("fresh",!0).on({adjust:f,destroy:function(){p.getParentNode().removeChild(p),e(window).off("resize",f)}}),o.markers&&o.markers.length&&null!=o.curr)i=o.markers[o.curr].map;else{if(!o.map)return;i=e.getLatLng(o.map),g=o.label}null!==(d=e.cookie("mapType"))&&(o.type=d),null!==(d=e.cookie("mapZoom"))&&(o.zoom=parseInt(d,10)||o.zoom),setTimeout(function(){var m,d=new google.maps.Map(l[0],{zoom:o.zoom,center:i,scrollwheel:!1,mapTypeId:o.type.toLowerCase()});if(google.maps.event.addListener(d,"maptypeid_changed",function(){e.cookie("mapType",e.fn.addMap.defaults.type=d.getMapTypeId(),3600)}),google.maps.event.addListener(d,"zoom_changed",function(){e.cookie("mapZoom",e.fn.addMap.defaults.zoom=d.getZoom(),3600)}),o.markers&&o.markers.length>1){var f,w,k,y=Math.max(o.curr-o.range,0),z=Math.min(o.curr+o.range,o.markers.length),v=function(){o.click.call(this)};for(f=y;z>f;f++)k=o.markers[f],w={position:k.map,map:d,title:k.label,icon:f===o.curr?n:r,shadow:s,zIndex:f===o.curr?999:f},m=new google.maps.Marker(w),e.isFunction(o.click)&&k.link&&(m.link=k.link,google.maps.event.addListener(m,"click",v)),h.push(m)}else m=new google.maps.Marker(e.extend({position:i,map:d,title:g},a));l.css({top:0}).appendTo(c),p=d,u=o.curr,c.on("setactive",function(o,n){e.isArray(h)&&h.length&&(u>=y&&(h[u].setIcon(t),h[u].setZIndex(u)),"undefined"!=typeof n&&n>=y&&n<y+h.length?(h[n-y].setIcon(a),h[n-y].setZIndex(9999),p.setCenter(h[n-y].position),u=n):u=-1)})},20),e(window).on("resize",function(){clearTimeout(m),c.data("fresh",!0),m=setTimeout(f,100)})})},e.fn.addMap.defaults={type:"roadmap",zoom:16,range:30,resPath:""}}(jQuery);